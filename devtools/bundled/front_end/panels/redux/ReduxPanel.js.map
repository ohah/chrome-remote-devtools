{"version":3,"file":"ReduxPanel.js","sourceRoot":"","sources":["../../../../../../front_end/panels/redux/ReduxPanel.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as UI from '../../ui/legacy/legacy.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as ProtocolClient from '../../core/protocol_client/protocol_client.js';\nimport * as Root from '../../core/root/root.js';\nimport { ReduxExtensionBridge } from './ReduxExtensionBridge.js';\n\nexport class ReduxPanel extends UI.Panel.Panel {\n  #iframe: HTMLIFrameElement | null = null;\n  #bridge: ReduxExtensionBridge;\n  #target: SDK.Target.Target | null = null;\n\n  constructor() {\n    super('redux');\n    this.setHideOnDetach();\n\n    this.#bridge = new ReduxExtensionBridge();\n\n    // Create iframe directly / iframe 직접 생성\n    this.#iframe = document.createElement('iframe');\n    this.#iframe.className = 'redux-devtools-iframe';\n    this.#iframe.style.width = '100%';\n    this.#iframe.style.height = '100%';\n    this.#iframe.style.border = 'none';\n\n    // Build URL for devpanel.html / devpanel.html URL 구성\n    // Use the same base URL as the current page / 현재 페이지와 동일한 base URL 사용\n    const remoteBase = Root.Runtime.getRemoteBase();\n    let reduxDevToolsPage: Platform.DevToolsPath.UrlString;\n    if (remoteBase) {\n      // Use remote base if available / remote base가 있으면 사용\n      reduxDevToolsPage = `${remoteBase.base}panels/redux/extension/devpanel.html` as Platform.DevToolsPath.UrlString;\n    } else {\n      // Fallback to relative path / 상대 경로로 폴백\n      const currentPath = window.location.pathname;\n      const basePath = currentPath.substring(0, currentPath.lastIndexOf('/'));\n      reduxDevToolsPage = `${basePath}/panels/redux/extension/devpanel.html` as Platform.DevToolsPath.UrlString;\n    }\n    this.#iframe.src = reduxDevToolsPage;\n\n    this.#iframe.onload = () => {\n      if (this.#iframe?.contentWindow) {\n        this.#bridge.initialize(this.#iframe.contentWindow);\n      }\n    };\n\n    this.contentElement.appendChild(this.#iframe);\n\n    // Setup CDP listener / CDP 리스너 설정\n    this.setupCDPListener();\n  }\n\n  override wasShown(): void {\n    super.wasShown();\n    this.setupCDPListener();\n  }\n\n  override willHide(): void {\n    super.willHide();\n    this.cleanupCDPListener();\n  }\n\n\n  private setupCDPListener(): void {\n    const target = SDK.TargetManager.TargetManager.instance().primaryPageTarget();\n    if (!target) {\n      SDK.TargetManager.TargetManager.instance().addEventListener(\n        SDK.TargetManager.Events.AVAILABLE_TARGETS_CHANGED,\n        () => {\n          const newTarget = SDK.TargetManager.TargetManager.instance().primaryPageTarget();\n          if (newTarget && !this.#target) {\n            this.#target = newTarget;\n            this.attachToTarget(newTarget);\n          }\n        },\n        this\n      );\n      return;\n    }\n\n    this.#target = target;\n    this.attachToTarget(target);\n  }\n\n  private attachToTarget(target: SDK.Target.Target): void {\n    const router = target.router();\n    if (!router?.connection) {\n      return;\n    }\n\n    // Redux CDP 이벤트를 bridge로 전달 / Redux CDP 이벤트를 bridge로 전달\n    this.#bridge.attachToTarget(target, router.connection);\n  }\n\n  private cleanupCDPListener(): void {\n    this.#bridge.cleanup();\n  }\n}\n\n\n"]}
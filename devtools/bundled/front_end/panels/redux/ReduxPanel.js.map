{"version":3,"file":"ReduxPanel.js","sourceRoot":"","sources":["../../../../../../front_end/panels/redux/ReduxPanel.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as Platform from '../../core/platform/platform.js';\nimport * as Root from '../../core/root/root.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport { getReduxExtensionBridge, initializeReduxBridge, type ReduxExtensionBridge } from './ReduxExtensionBridge.js';\n\nexport class ReduxPanel extends UI.Panel.Panel {\n  #iframe: HTMLIFrameElement | null = null;\n  #bridge: ReduxExtensionBridge;\n\n  constructor() {\n    super('redux');\n    this.setHideOnDetach();\n\n    // Initialize global bridge if not already / 전역 bridge 초기화 (아직 안 되었으면)\n    initializeReduxBridge();\n\n    // Use global singleton bridge / 전역 싱글톤 bridge 사용\n    this.#bridge = getReduxExtensionBridge();\n\n    // Create iframe directly / iframe 직접 생성\n    this.#iframe = document.createElement('iframe');\n    this.#iframe.className = 'redux-devtools-iframe';\n    this.#iframe.style.width = '100%';\n    this.#iframe.style.height = '100%';\n    this.#iframe.style.border = 'none';\n\n    // Build URL for plugin HTML / 플러그인 HTML URL 구성\n    // Use the same base URL as the current page / 현재 페이지와 동일한 base URL 사용\n    const remoteBase = Root.Runtime.getRemoteBase();\n    let reduxDevToolsPage: Platform.DevToolsPath.UrlString;\n    if (remoteBase) {\n      // Use remote base if available / remote base가 있으면 사용\n      reduxDevToolsPage = `${remoteBase.base}panels/plugins/redux-plugin/index.html` as Platform.DevToolsPath.UrlString;\n    } else {\n      // Fallback to relative path / 상대 경로로 폴백\n      const currentPath = window.location.pathname;\n      const basePath = currentPath.substring(0, currentPath.lastIndexOf('/'));\n      reduxDevToolsPage = `${basePath}/panels/plugins/redux-plugin/index.html` as Platform.DevToolsPath.UrlString;\n    }\n\n    // Set iframe source / iframe 소스 설정\n    this.#iframe.src = reduxDevToolsPage;\n\n    this.#iframe.onload = () => {\n      if (this.#iframe?.contentWindow) {\n        // Wait a bit for iframe content to fully load / iframe 콘텐츠가 완전히 로드될 때까지 약간 대기\n        setTimeout(() => {\n          if (this.#iframe?.contentWindow) {\n            // Initialize iframe window - this will flush buffered messages / iframe window 초기화 - 버퍼된 메시지가 전송됨\n            this.#bridge.initialize(this.#iframe.contentWindow);\n          }\n        }, 100);\n      }\n    };\n\n    // Append iframe to content element / iframe을 content element에 추가\n    this.contentElement.appendChild(this.#iframe);\n  }\n\n  override wasShown(): void {\n    super.wasShown();\n    // When panel is shown, flush buffered messages again for new connections / 패널이 표시될 때 새 연결을 위해 버퍼된 메시지를 다시 플러싱\n    // This ensures history is sent when panel is reopened / 패널이 다시 열릴 때 히스토리가 전송되도록 보장\n    if (this.#iframe?.contentWindow) {\n      // Re-initialize to flush buffer / 버퍼를 플러싱하기 위해 재초기화\n      this.#bridge.initialize(this.#iframe.contentWindow);\n    }\n\n    // When panel is shown, ensure START message is sent / 패널이 표시될 때 START 메시지가 전송되도록 보장\n    // This handles the case where Extension didn't call connect / Extension이 connect를 호출하지 않은 경우 처리\n    const target = SDK.TargetManager.TargetManager.instance().primaryPageTarget();\n    if (this.#iframe?.contentWindow && target) {\n      setTimeout(() => {\n        this.#bridge.sendStartMessageToPageIfNeeded();\n      }, 500);\n    }\n  }\n\n  override willHide(): void {\n    super.willHide();\n    // Don't cleanup - bridge is global and keeps listening / 정리하지 않음 - bridge는 전역이고 계속 리스닝\n  }\n}\n"]}